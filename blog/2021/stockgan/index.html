<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Generating Realistic Stock Market Order Streams - A Summary | Deepak Gouda</title> <meta name="author" content="Deepak Gouda"/> <meta name="description" content="A summary of StockGANs - a market data simulator"/> <meta name="keywords" content="academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/title-icon.png"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://deepakgouda.github.io/blog/2021/stockgan/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://deepakgouda.github.io/"><span class="font-weight-bold">Deepak</span> Gouda</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/shots/">shots</a> </li> <li class="nav-item "> <a class="nav-link" href="/gallery/">gallery</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/talks/">talks</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/genealogy/">genealogy</a> <a class="dropdown-item" href="/checklist/">checklist</a> </div> </li> <div class="toggle-container"> <a id="light-toggle"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </a> </div> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Generating Realistic Stock Market Order Streams - A Summary</h1> <p class="post-meta">May 29, 2021</p> <p class="post-tags"> <a href="/blog/2021"> <i class="fas fa-calendar fa-sm"></i> 2021 </a>   ·   <a href="/blog/tag/research"> <i class="fas fa-hashtag fa-sm"></i> research</a>   <a href="/blog/tag/notes-and-summaries"> <i class="fas fa-hashtag fa-sm"></i> notes-and-summaries</a>   <a href="/blog/tag/machine-learning"> <i class="fas fa-hashtag fa-sm"></i> machine-learning</a>     ·   <a href="/blog/category/Research"> <i class="fas fa-tag fa-sm"></i> Research</a>   </p> </header> <article class="post-content"> <h2 id="terminologies-and-pre-requisite-knowledge">Terminologies and Pre-requisite knowledge</h2> <ul> <li><a href="https://arxiv.org/abs/1406.2661" target="_blank" rel="noopener noreferrer">Generative Adversarial Networks(GAN)</a></li> <li><a href="https://arxiv.org/abs/1701.07875" target="_blank" rel="noopener noreferrer">Wasserstein GAN</a></li> <li>Limit order - the maximum price at which a trader would be willing to buy a specified quantity of a stock, or the minimum price at which they ould be willing to sell a quantity.</li> <li>Best bid - the lowest buy price level.</li> <li>Best ask - the highest sell price level.</li> </ul> <h2 id="introduction">Introduction</h2> <ul> <li>Quant research and strategy development rely on orderbook and tradebook data of financial instruments to backtest and gauge the performance of a strategy.</li> <li>This paper aims to develop a simulator capable of producing market data at high fidelity and high realism, by learning a generator from real stock market data streams.</li> <li>The primary contribution is the architecture and formulation of Stock-GAN, a conditional GAN model based on Wasserstein GAN (WGAN) to produce realistic stock market order streams from real market data.</li> <li>Next contribution is the mathematical characterization of the distribution learned by the generator, which is modeled as a stochastic process with finite memory dependency.</li> <li>The generated data streams are evaluated based on the distributions of five parameters.</li> </ul> <h2 id="architecture-and-mathematical-characterization">Architecture and Mathematical characterization</h2> <ul> <li>Notation \(X\) : vector valued random variable, whose components include the time interval in between orders, type of order, limit order price, limit order quantity and the best bid and best ask prices.</li> <li>A conditional WGAN with both the generator and critic conditioned on a \(k\) length history of \(X\) and the time interval \(Δt\) is used for the architecture. \(k = 20\) is the chosen value.</li> <li>The history is condensed to one vector using a single LSTM layer. This vector and uniform noise of dimension 100 is fed to a fully connected layer followed by 4 convolution layers.</li> <li>When the generator executes after training it is fed its own generated data as history.</li> <li> <strong>Stock-GAN novel architectural features</strong> <ol> <li>A separate neural network (CDA network) that is used to approximate the double auction mechanism underlying stock exchanges. It consists of a fully connected layer followed by 3 convolutional layers. Its input is a limit order and the current best bid and best ask and the output is the next best bid and best ask. This network is trained separately using the orders and order-book data using a standard mean squared error loss.</li> <li>Inclusion of order-book information in the conditioning history of the network. The $k$ length history implies a finite history dependence of the current output $$x_i$ i.e.</li> </ol> \[P(x_i | x_{i−1} , ... , Δt) = P(x_i | x_{i−1} , ... , x_{i−m} , Δt)\] <p>for some <em>m</em> which is modelled as a higher order Markov Chain. As the modelled stochastic process cannot be described in a closed form, a neural network is used to learn this complex stochastic process.</p> </li> <li> <strong>Mathematical interpretations</strong> <ol> <li>The critic computes the Wasserstein distance between the joint distributions</li> </ol> \[P_{r}(x_{i}, ... , x_{i−k}, Δt)\text{ and }P_{g}(x_{i}, ... , x_{i−k} , Δt)\] <ol> <li>The generator represents the distribution</li> </ol> \[P_{g}(x_{i}, ... , x_{i−k} , Δt) = P_{g} (x_{i} | x_{i−1} , ... , x_{i−k} , Δt)P_{r}(x_{i−1} , ... , x_{i−k} , Δt)\] <p>where subscript <em>r</em> denotes distributions on real data and <em>g</em> denotes distributions on generated data.</p> </li> </ul> <p><img src="./images/StockGAN.png" alt=""></p> <h2 id="evaluation">Evaluation</h2> <p>The five proposed statistics to evaluate the fidelity of generated data are :</p> <ol> <li>Price: Distribution over price for the day’s limit orders, by order type.</li> <li>Quantity: Distribution over quantity for the day’s limit orders, by order type.</li> <li>Inter-arrival time: Distribution over inter-arrival duratio for the day’s limit orders, by order type.</li> <li>Intensity evolution: Number of orders for consecutive T-second chunks of time.</li> <li>Best bid/ask evolution: Changes in the best bid and ask over time as new orders arrive.</li> </ol> <ul> <li>The baseline distributions are generated using Variational Autoencoders and Deep Conditional GANs. The evaluation statistic used is Kolmogorov-Smirnoff distance.</li> <li>Ablation studies were performed by removing CDA network and orderbook information. Removing these two features lead to fewer high frequency components in comparison to synthetic data. Removing the CDA network leads to more high frequency components in comparison to real data.</li> </ul> <h2 id="limitations">Limitations</h2> <ul> <li>The time intervals chosen are for shorter durations only which can capture regular movements over a short interval. Accordingly, the evaluation data chosen is exclusive of external factors such as quarterly or annual financial performance reports.</li> </ul> <h2 id="paper-and-code">Paper and Code</h2> <ul> <li><a href="https://ojs.aaai.org//index.php/AAAI/article/view/5415" target="_blank" rel="noopener noreferrer">Paper</a></li> <li><a href="https://openreview.net/pdf?id=rke41hC5Km" target="_blank" rel="noopener noreferrer">Code Snippets</a></li> </ul> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container" style="text-align:center;"> © Copyright 2025 Deepak Gouda. <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer"> Template here!</a>. All images are my own. Last updated: February 06, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script src="/assets/js/zoom.js"></script> <script src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>