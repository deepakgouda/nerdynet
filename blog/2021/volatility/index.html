<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Volatility Essentials | Deepak Gouda</title> <meta name="author" content="Deepak Gouda"/> <meta name="description" content="Essential commands I use in memory forensics"/> <meta name="keywords" content="academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/title-icon.png"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://deepakgouda.github.io/blog/2021/volatility/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://deepakgouda.github.io/"><span class="font-weight-bold">Deepak</span> Gouda</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/shots/">shots</a> </li> <li class="nav-item "> <a class="nav-link" href="/gallery/">gallery</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/talks/">talks</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/genealogy/">genealogy</a> <a class="dropdown-item" href="/checklist/">checklist</a> </div> </li> <div class="toggle-container"> <a id="light-toggle"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </a> </div> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Volatility Essentials</h1> <p class="post-meta">January 2, 2021</p> <p class="post-tags"> <a href="/blog/2021"> <i class="fas fa-calendar fa-sm"></i> 2021 </a>   ·   <a href="/blog/tag/tech"> <i class="fas fa-hashtag fa-sm"></i> tech</a>   <a href="/blog/tag/infosec"> <i class="fas fa-hashtag fa-sm"></i> infosec</a>     ·   <a href="/blog/category/InfoSec"> <i class="fas fa-tag fa-sm"></i> InfoSec</a>   </p> </header> <article class="post-content"> <h1 id="list-of-essential-volatility-commands">List of essential Volatility commands</h1> <p>Volatility is an open-source tool which I use for memory analysis. Given a memory dump, volatility can be tagged with numerous extensions to trace processes, get memory dumps, list active network connections, get browser history, analyse command line history or copy clipboard as well.</p> <p>Here are the essential commands I use often in CTFs.</p> <ol> <li>Imageinfo <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> volatility <span class="nt">-f</span> Win7mem.raw imageinfo
</code></pre></div> </div> </li> <li>Processes <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> volatility <span class="nt">-f</span> Win7mem.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 pslist
 volatility <span class="nt">-f</span> Win7mem.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 pstree
 volatility <span class="nt">-f</span> Win7mem.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 psxview
</code></pre></div> </div> </li> <li>cmd <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> volatility <span class="nt">-f</span> Win7mem.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 cmdscan
 volatility <span class="nt">-f</span> Win7mem.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 consoles
 volatility <span class="nt">-f</span> Win7mem.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 cmdline
</code></pre></div> </div> </li> <li>Clipboard <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> volatility <span class="nt">-f</span> Win7mem.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 clipboard
</code></pre></div> </div> </li> <li>Dumps <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> volatility <span class="nt">-f</span> Win7mem.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 procdump <span class="nt">-p</span> 1976 <span class="nt">--dump-dir</span> ./dumps <span class="c"># Process executable</span>
 volatility <span class="nt">-f</span> Win7mem.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 memdump <span class="nt">-p</span> 1976 <span class="nt">--dump-dir</span> ./dumps <span class="c"># Process addressable memory</span>
</code></pre></div> </div> <p>Next, do a <code class="language-plaintext highlighter-rouge">strings</code> + <code class="language-plaintext highlighter-rouge">grep</code> for the required keyword on the <code class="language-plaintext highlighter-rouge">.dmp</code> files.</p> </li> <li>Dump files <div class="language-bash highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> volatility <span class="nt">-f</span> Win7mem.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 dumpfiles <span class="nt">-D</span> dumps <span class="nt">-r</span> evt<span class="nv">$ </span><span class="nt">-i</span> <span class="nt">-S</span> dumps/summary.txt <span class="c"># -r flag is regex, evt$ for files ending with evt</span>
</code></pre></div> </div> </li> </ol> <h1 id="usage-in-ctfs">Usage in CTFs</h1> <p>I’ll also list my solutions to one of the CTFs I’ve participated in, <a href="https://ctftime.org/event/1149" target="_blank" rel="noopener noreferrer">Vulncon 2020</a> The challenges simulate an event where a maleware was sent as an email attachment to the victim. Some time after the attachment was downloaded, the computer crashed. We are provided a memory dump before the crash.</p> <h3 id="challenge-1-find-the-last-website-visited-by-the-victim-along-with-timestamp">Challenge 1: Find the last website visited by the victim along with timestamp</h3> <p>Use chromehistory plugin.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>volatility <span class="nt">--plugins</span><span class="o">=</span>volatility-plugins <span class="nt">--profile</span><span class="o">=</span><span class="nt">----</span> <span class="nt">-f</span> dump.raw
</code></pre></div></div> <p>Flag : <em>vulncon{gamblingsites.org-12-12-2020}</em></p> <h3 id="challenge-2-find-the-device-id-of-attached-usb-stick">Challenge 2: Find the device id of attached USB stick</h3> <p>Use usbstor plugin.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>volatility <span class="nt">--plugins</span><span class="o">=</span>kevthehermit-volatility_plugins/ <span class="nt">-f</span> dump.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 usbstor
</code></pre></div></div> <p>Flag : <em>vulncon{68b70eb8-f3fd-5099-907d-4e542601b2c7}</em></p> <h3 id="challenge-3-find-the-email-id-from-which-the-mail-was-sent">Challenge 3: Find the email id from which the mail was sent</h3> <p>It can be observed that the email client used is <em>mailspring</em>. So we analyse the memory dump of <em>mailspring</em>. Pid of mailspring is <strong>2596</strong></p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>volatility <span class="nt">-f</span> dump.raw <span class="nt">--profile</span><span class="o">=</span>Win7SP1x64 memdump <span class="nt">-p</span> 2596 <span class="nt">--dump-dir</span> ./memdumps
strings 2596.dmp | <span class="nb">grep </span>mail | <span class="nb">grep</span> <span class="s2">":)"</span> | less
</code></pre></div></div> <p>Flag : <em>vulncon{sarojchaudhary581@gmail.com}</em></p> <h3 id="links">Links</h3> <ol> <li><a href="https://github.com/volatilityfoundation/volatility/wiki/Command-Reference" target="_blank" rel="noopener noreferrer">Official Doc</a></li> <li><a href="https://digital-forensics.sans.org/media/volatility-memory-forensics-cheat-sheet.pdf" target="_blank" rel="noopener noreferrer">Cheatsheet</a></li> <li><a href="https://medium.com/@zemelusa/first-steps-to-volatile-memory-analysis-dcbd4d2d56a1" target="_blank" rel="noopener noreferrer">Source1</a></li> <li><a href="https://medium.com/@melanijan93/write-up-memory-forensics-in-the-def-con-dfir-ctf-c2b50ed62c6b" target="_blank" rel="noopener noreferrer">DEFCON DFIR</a></li> <li> <a href="https://reverseengineering.stackexchange.com/questions/16176/volatility-manually-inspect-heap-of-a-process" target="_blank" rel="noopener noreferrer">Heap inspection</a> of a process</li> <li><a href="https://ctftime.org/writeup/24113" target="_blank" rel="noopener noreferrer">BSidesDelhi 2020</a></li> </ol> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container" style="text-align:center;"> © Copyright 2025 Deepak Gouda. <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer"> Template here!</a>. All images are my own. Last updated: February 06, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script src="/assets/js/zoom.js"></script> <script src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>