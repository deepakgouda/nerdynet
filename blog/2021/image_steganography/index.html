<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Image Steganography | Deepak Gouda</title> <meta name="author" content="Deepak Gouda"/> <meta name="description" content="My checklist for image steganography challenges in CTFs"/> <meta name="keywords" content="academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/title-icon.png"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://deepakgouda.github.io/blog/2021/image_steganography/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://deepakgouda.github.io/"><span class="font-weight-bold">Deepak</span> Gouda</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/shots/">shots</a> </li> <li class="nav-item "> <a class="nav-link" href="/gallery/">gallery</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/talks/">talks</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/genealogy/">genealogy</a> <a class="dropdown-item" href="/checklist/">checklist</a> </div> </li> <div class="toggle-container"> <a id="light-toggle"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </a> </div> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Image Steganography</h1> <p class="post-meta">January 9, 2021</p> <p class="post-tags"> <a href="/blog/2021"> <i class="fas fa-calendar fa-sm"></i> 2021 </a>   ·   <a href="/blog/tag/tech"> <i class="fas fa-hashtag fa-sm"></i> tech</a>   <a href="/blog/tag/infosec"> <i class="fas fa-hashtag fa-sm"></i> infosec</a>     ·   <a href="/blog/category/InfoSec"> <i class="fas fa-tag fa-sm"></i> InfoSec</a>   </p> </header> <article class="post-content"> <h1 id="image-steganography-checklist">Image steganography checklist</h1> <h3 id="file"><code class="language-plaintext highlighter-rouge">file</code></h3> <p>Often the file presented might not be what is apparent from its extension. Unlike windows, Linux doesn’t identify file type from its name, but its file header or commonly known as file signature or magic header. For instance, a <em>jpeg</em> image can be renamed as <em>png</em>.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  file doh.jpg  
doh.jpg: JPEG image data, JFIF standard 1.01, aspect ratio, density 72x72, segment length 16, baseline, precision 8, 581x600, frames 3
➜  <span class="nb">mv </span>doh.jpg doh.png 
➜  file doh.png 
doh.png: JPEG image data, JFIF standard 1.01, aspect ratio, density 72x72, segment length 16, baseline, precision 8, 581x600, frames 3
</code></pre></div></div> <p>File header of a png file :</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  hexdump <span class="nt">-C</span> peter.png | <span class="nb">head 
</span>00000000  89 50 4e 47 0d 0a 1a 0a  00 00 00 0d 49 48 44 52  |.PNG........IHDR|
00000010  00 00 03 ca 00 00 03 ca  08 03 00 00 00 7b b1 53  |.............<span class="o">{</span>.S|
00000020  06 00 00 12 0d 7a 54 58  74 52 61 77 20 70 72 6f  |.....zTXtRaw pro|
00000030  66 69 6c 65 20 74 79 70  65 20 65 78 69 66 00 00  |file <span class="nb">type </span>exif..|
00000040  78 da ad 9a 6b 96 15 a9  d2 86 ff 33 8a 33 04 82  |x...k......3.3..|
00000050  3b c3 81 08 58 eb cc e0  1b fe 79 22 f7 b6 b4 d4  |<span class="p">;</span>...X.....y<span class="s2">"....|
00000060  6e ed af ad 5a ba cb 34  21 21 2e ef 85 ac 70 fe  |n...Z..4!!....p.|
00000070  ef bf 37 fc 87 af 32 53  0a a5 f6 d1 66 6b 91 af  |..7...2S....fk..|
00000080  32 b9 b4 f8 61 c4 d7 d7  eb 53 62 79 fe 7e be 74  |2...a....Sby.~.t|
00000090  c5 fc be fa e9 7a f8 f8  8f c4 25 ff e9 f5 af d8  |.....z....%.....|
</span></code></pre></div></div> <h3 id="strings"><code class="language-plaintext highlighter-rouge">strings</code></h3> <p>A common tool to print the ascii characters in a file. It often reveals embedded comments or metadata.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  strings Save<span class="se">\ </span>Me.mp3 | <span class="nb">grep </span>rtcp<span class="o">{</span>
 rtcp<span class="o">{</span>j^cks0n_3ats_r1c3<span class="o">}</span>
</code></pre></div></div> <h3 id="exiftool"><code class="language-plaintext highlighter-rouge">exiftool</code></h3> <p>Reveals image or audio metadata. Often reveals hidden comments.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  exiftool img.jpg 
 ExifTool Version Number         : 10.80
 File Name                       : img.jpg
 Directory                       : <span class="nb">.</span>
 File Size                       : 769 bytes
 File Modification Date/Time     : 2020:01:23 04:02:46+05:30
 File Access Date/Time           : 2020:01:23 04:02:57+05:30
 File Inode Change Date/Time     : 2020:01:23 04:02:46+05:30
 File Permissions                : rw-rw-r--
 File Type                       : JPEG
 File Type Extension             : jpg
 MIME Type                       : image/jpeg
 JFIF Version                    : 1.01
 Resolution Unit                 : None
 X Resolution                    : 1
 Y Resolution                    : 1
 Image Width                     : 9
 Image Height                    : 6
 Encoding Process                : Baseline DCT, Huffman coding
 Bits Per Sample                 : 8
 Color Components                : 3
 Y Cb Cr Sub Sampling            : YCbCr4:2:0 <span class="o">(</span>2 2<span class="o">)</span>
 Image Size                      : 9x6
 Megapixels                      : 0.000054
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
### `zsteg` and `jsteg`

zsteg works on png and jsteg works on jpg files. Used to reveal LSB embeddings

```bash
➜  zsteg rev_file.png 
 /usr/lib/ruby/2.5.0/open3.rb:199: warning: Insecure world writable dir /media/epsilon/Playground/Work/IIT/Sem 7/BTP in PATH, mode 040777
 b1,r,lsb,xy         .. text: "r]ve'g~&gt;V@"
 b1,b,lsb,xy         .. file: PGP\011Secret Key -
 b1,rgb,lsb,xy       .. text: "rtcp{^ww3_1_b3l31v3_1n_y0u!}"
</code></pre></div></div> <h3 id="pngcheck"><code class="language-plaintext highlighter-rouge">pngcheck</code></h3> <p>Checks the validity of a png file. Often used along with a hex editor like <em><a href="https://hexinator.com/" target="_blank" rel="noopener noreferrer">hexinator</a></em> to fix corrupted png files. Fixes include correcting the file headers or byte checksums.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  pngcheck Mad_Libs.png 
OK: Mad_Libs.png <span class="o">(</span>1089x544, 32-bit RGB+alpha, non-interlaced, 95.2%<span class="o">)</span><span class="nb">.</span>
</code></pre></div></div> <h3 id="stegonline"><code class="language-plaintext highlighter-rouge">stegonline</code></h3> <p>This <a href="https://stegonline.georgeom.net/upload" target="_blank" rel="noopener noreferrer">site</a> has a bunch of tools which allow you to browse through color planes, reveal LSB embeddings or inverse RGB.</p> <h3 id="stegcracker"><code class="language-plaintext highlighter-rouge">stegcracker</code></h3> <p>Bruteforce image with a wordlist. An improved utility <a href="https://github.com/RickdeJager/stegseek" target="_blank" rel="noopener noreferrer">stegseek</a> has replaced stegcracker.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  stegcracker &lt;file&gt; <span class="o">[</span>&lt;wordlist&gt;]
</code></pre></div></div> <h3 id="steghide"><code class="language-plaintext highlighter-rouge">steghide</code></h3> <p>Extract information from an image or audio file with a given password. Once a while blank passwords work as well.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  steghide extract <span class="nt">-sf</span> &lt;file&gt;
</code></pre></div></div> <h3 id="stegsnow-or-snow"><code class="language-plaintext highlighter-rouge">stegsnow or snow</code></h3> <p>Hides information in text files in form of trailing whitespaces.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  snow <span class="nt">-C</span> &lt;file&gt;
</code></pre></div></div> <h3 id="binwalk"><code class="language-plaintext highlighter-rouge">binwalk</code></h3> <p>Reveals and extracts files embedded in images or audio files. With a known offset, <code class="language-plaintext highlighter-rouge">dd</code> can be used to extract specific file manually as well.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  binwalk <span class="nt">-v</span> &lt;file&gt; <span class="c"># reveals embedded files and their offsets</span>
➜  binwalk <span class="nt">-e</span> &lt;file&gt; <span class="c"># extracts embedded files</span>
➜  <span class="nb">dd </span><span class="k">if</span><span class="o">=</span>&lt;input file&gt; <span class="nv">of</span><span class="o">=</span>&lt;output file&gt; <span class="nv">skip</span><span class="o">=</span>&lt;offset&gt; <span class="nv">bs</span><span class="o">=</span>4M
</code></pre></div></div> <h3 id="foremost"><code class="language-plaintext highlighter-rouge">foremost</code></h3> <p>Performs a function similar to binwalk</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>➜  foremost <span class="nt">-v</span> &lt;file&gt;
</code></pre></div></div> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container" style="text-align:center;"> © Copyright 2025 Deepak Gouda. <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer"> Template here!</a>. All images are my own. Last updated: February 06, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script src="/assets/js/zoom.js"></script> <script src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>