<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Kibana | Deepak Gouda</title> <meta name="author" content="Deepak Gouda"/> <meta name="description" content="Setting up Kibana module of ELK stack [Part 4]."/> <meta name="keywords" content="academic-website, portfolio-website"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="/assets/img/title-icon.png"/> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://deepakgouda.github.io/blog/2021/kibana/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://deepakgouda.github.io/"><span class="font-weight-bold">Deepak</span> Gouda</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/shots/">shots</a> </li> <li class="nav-item "> <a class="nav-link" href="/gallery/">gallery</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/talks/">talks</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item" href="/genealogy/">genealogy</a> <a class="dropdown-item" href="/checklist/">checklist</a> </div> </li> <div class="toggle-container"> <a id="light-toggle"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </a> </div> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Kibana</h1> <p class="post-meta">February 27, 2021</p> <p class="post-tags"> <a href="/blog/2021"> <i class="fas fa-calendar fa-sm"></i> 2021 </a>   ·   <a href="/blog/tag/tech"> <i class="fas fa-hashtag fa-sm"></i> tech</a>   <a href="/blog/tag/framework"> <i class="fas fa-hashtag fa-sm"></i> framework</a>   <a href="/blog/tag/setup"> <i class="fas fa-hashtag fa-sm"></i> setup</a>     ·   <a href="/blog/category/Setup"> <i class="fas fa-tag fa-sm"></i> Setup</a>   </p> </header> <article class="post-content"> <p>This article is the fourth module of the <strong>Self-managed ELK Stack</strong> article behind <a href="https://www.deepakgouda.com/Self-managed-ELK-Stack" target="_blank" rel="noopener noreferrer">Introduction</a>, <a href="https://www.deepakgouda.com/Filebeat" target="_blank" rel="noopener noreferrer">Filebeat</a> and <a href="https://www.deepakgouda.com/Logstash" target="_blank" rel="noopener noreferrer">Logstash</a>. Hence, it is recommended to go through the aforementioned articles before proceeding with Kibana.</p> <h2 id="creating-visualizations-from-filtered-data">Creating visualizations from filtered data</h2> <ol> <li>Open <em>Kibana</em> -&gt; <em>Discover</em> </li> <li>Select appropriate index (<code class="language-plaintext highlighter-rouge">sample_index*</code>) and necessary columns</li> <li>Click on <em>Save</em> to save your discover search so you can use it in visualizations and dashboards</li> <li>If this is your first time using Kibana visualizations, you must reload your field list before proceeding. To reload, <em>Stack Management</em> -&gt; <em>Index Patterns</em> -&gt; <em>hft_file*</em> -&gt; <em>Refresh file list</em> icon (on top right)</li> <li>Click on <em>Visualize</em> and create a new visualization</li> <li>Click on <em>Dashboard</em> and create a new dashboard and add the visualization</li> </ol> <h2 id="aggregation-query">Aggregation query</h2> <div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">POST</span><span class="w"> </span><span class="err">/sample_index/_search</span><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="nl">"aggs"</span><span class="p">:</span><span class="w"> 
  </span><span class="p">{</span><span class="w">
    </span><span class="nl">"eq_entries"</span><span class="p">:</span><span class="w"> 
    </span><span class="p">{</span><span class="w">
      </span><span class="nl">"aggs"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"min_ts"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nl">"min"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nl">"field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@timestamp"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"terms"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"field"</span><span class="p">:</span><span class="w"> </span><span class="s2">"agent.keyword"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div> <h2 id="visualization-tools">Visualization tools</h2> <p>Most of visualization tools like bar and line charts are pretty straightforward and intuitive to work with. I have mentioned a couple of more advanced tools that are not completely GUI based.</p> <h3 id="timelion">Timelion</h3> <p>Can be used to plot time series sequential data and allows mathematical operations. For instance, it can be used to perform point wise subtraction of two timestamp sequences to obtain latency.</p> <h4 id="sample-syntax">Sample syntax</h4> <ol> <li>Offset a sequence of data by 1 hour and plot the count of logs with label <code class="language-plaintext highlighter-rouge">last_hour</code>.</li> </ol> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  .es(offset=-1h,index=sample-filebeat,timefield='@timestamp',metric=count).label('last_hour')
</code></pre></div></div> <ol> <li>Plot a bar graph of the frequency of logs containing the field <code class="language-plaintext highlighter-rouge">condition_type</code> such that <code class="language-plaintext highlighter-rouge">condition_type == exit</code> </li> </ol> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  .es(index=sample-filebeat,timefield='@timestamp', metric=count,q='_exists_ : condition_type AND condition_type : exit').label('exit').bars(width=10,stack=yes),
  .es(index=sample-filebeat,timefield='@timestamp', metric=count,q='_exists_ : condition_type AND condition_type : entry').label('entry').bars(width=10,stack=yes)
</code></pre></div></div> <ol> <li>Plot the sum of field <code class="language-plaintext highlighter-rouge">quantity</code> of logs containing the field <code class="language-plaintext highlighter-rouge">condition_type</code> such that <code class="language-plaintext highlighter-rouge">condition_type == entry</code> and assign the label <code class="language-plaintext highlighter-rouge">entry_sum</code> </li> </ol> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  .es(index=sample-filebeat,timefield='@timestamp', metric='sum:quantity.value',q='_exists_ : condition_type AND condition_type : entry').sum().label('entry_sum')
</code></pre></div></div> <h4 id="additional-links">Additional Links</h4> <ol> <li><a href="https://www.elastic.co/guide/en/kibana/7.10/timelion-tutorial-create-time-series-visualizations.html" target="_blank" rel="noopener noreferrer">Visualization</a></li> <li><a href="https://www.elastic.co/guide/en/kibana/7.10/timelion-tutorial-create-visualizations-withconditional-logic-and-tracking-trends.html" target="_blank" rel="noopener noreferrer">Conditional Logic</a></li> <li><a href="https://www.elastic.co/guide/en/kibana/6.8/timelion-math.html" target="_blank" rel="noopener noreferrer">Mathematical funtions</a></li> <li><a href="https://coralogix.com/log-analytics-blog/advanced-guide-to-kibana-timelion-functions/" target="_blank" rel="noopener noreferrer">Aggregations(Highly useful)</a></li> <li><a href="https://www.elastic.co/blog/sparse-timeseries-and-timelion" target="_blank" rel="noopener noreferrer">Sparse time series</a></li> </ol> <h3 id="vega">Vega</h3> <p>Similar to Timelion but provides support for more complex queries such as groupby aggregations.</p> <ol> <li><a href="https://stackoverflow.com/questions/60151507/filtering-an-aggregated-chart-with-another-aggregation-field" target="_blank" rel="noopener noreferrer">Visualization</a></li> <li><a href="https://john.soban.ski/aggregations-the-elasticsearch-group-by.html" target="_blank" rel="noopener noreferrer">Aggregation</a></li> </ol> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container" style="text-align:center;"> © Copyright 2025 Deepak Gouda. <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer"> Template here!</a>. All images are my own. Last updated: February 06, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.2/dist/umd/popper.min.js" integrity="sha256-l/1pMF/+J4TThfgARS6KwWrk/egwuVvhRzfLAMQ6Ds4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.min.js" integrity="sha256-SyTu6CwrfOhaznYZPoolVw2rxoY7lKYKQvqbtqN93HI=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script src="/assets/js/zoom.js"></script> <script src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>